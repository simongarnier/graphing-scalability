<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <title>Elasticsearch scalability test</title>
  </head>
  <style>

  </style>
  <body>
    <div id='chart'></div>
  </body>
  <link href='https://rawgit.com/masayuki0812/c3/master/c3.css' rel='stylesheet' type='text/css'>

  <script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.js' charset='utf-8'></script>
  <script src='https://rawgit.com/masayuki0812/c3/master/c3.js'></script>
  <script>
    //parsing the raw data
    var y_lenght = 5
    var data = [
      {"x" : "2014-07-01", "y" : [0.010953015, 0.015418875, 0.013470382, 0.39686572, 0.017411136]},
      {"x" : "2014-07-02", "y" : [0.006341847, 0.019205445, 0.438776777, 0.006418924, 0.006020337]},
      {"x" : "2014-07-03", "y" : [0.006337073, 0.006616332, 0.416648133, 0.006869453, 0.009414221]},
      {"x" : "2014-07-04", "y" : [0.005166922, 0.672147063, 0.004500718, 0.005499365, 0.009619167]},
      {"x" : "2014-07-05", "y" : [31.611538059, 0.00398558, 0.575408934, 0.003819944, 0.021778847]},
      {"x" : "2014-07-06", "y" : [22.477692684, 0.420585561, 0.004436883, 0.005493159, 0.003798541]},
      {"x" : "2014-07-07", "y" : [22.58534453, 0.003756513, 0.005675898, 0.46370962, 0.004291002]},
      {"x" : "2014-07-08", "y" : [47.212638211, 0.00487277, 0.197374343, 0.003933572, 0.004277472]},
      {"x" : "2014-07-09", "y" : [35.706989496, 0.006281307, 0.005027913, 0.633545143, 0.00311324]},
      {"x" : "2014-07-10", "y" : [21.467219733, 21.63664689, 0.003694051, 0.552565794, 0.007232362]},
      {"x" : "2014-07-11", "y" : [30.145343485, 21.351565388, 0.004374412, 0.006095809, 0.318616807]},
      {"x" : "2014-07-12", "y" : [22.35898937, 19.148706884, 0.00641193, 0.006245904, 0.003795294]},
      {"x" : "2014-07-13", "y" : [21.927355068, 19.175846194, 0.006099781, 0.006366198, 0.003758001]},
      {"x" : "2014-07-14", "y" : [20.709441916, 19.147300096, 0.006286437, 0.005230671, 0.005418951]},
      {"x" : "2014-07-15", "y" : [20.584720108, 19.101546229, 0.004102772, 0.003902454, 0.003230608]},
      {"x" : "2014-07-16", "y" : [19.712053399, 19.353380989, 0.006307797, 0.005483226, 0.005640078]},
      {"x" : "2014-07-17", "y" : [20.855903398, 19.188630843, 0.006165696, 0.004234321, 0.004476452]},
      {"x" : "2014-07-18", "y" : [21.851665333, 19.594042955, 0.003547493, 0.003647041, 0.005221273]},
      {"x" : "2014-07-19", "y" : [21.821907274, 19.939583062, 0.005793488, 0.00439599, 0.005622886]},
      {"x" : "2014-07-20", "y" : [20.276437867, 19.377874652, 0.006458899, 3.818320057, 0.006004007]},
      {"x" : "2014-07-21", "y" : [24.780140858, 20.041828556, 0.007230025, 1.124885131, 0.006543942]},
      {"x" : "2014-07-22", "y" : [27.723905375, 26.0827272, 0.022904611, 0.585386733, 0.004936555]},
      {"x" : "2014-07-23", "y" : [28.577423034, 19.773142647, 7.064998663, 0.566243441, 0.035511538]},
      {"x" : "2014-07-24", "y" : [35.994485854, 32.350809533, 3.148479, 1.218333837, 0.006284722]},
      {"x" : "2014-07-25", "y" : [35.362853539, 45.130340626, 0.022567675, 1.110525794, 6.78666938]},
      {"x" : "2014-07-26", "y" : [31.982361846, 32.172720272, 0.037028848, 0.999327837, 6.861004444]},
      {"x" : "2014-07-27", "y" : [31.381111483, 32.593171577, 0.018008322, 4.116005549, 5.920917522]},
      {"x" : "2014-07-28", "y" : [38.628281494, 37.946354556, 1.16875724, 0.996432652, 16.898940237]},
      {"x" : "2014-07-29", "y" : [31.841342043, 32.706564731, 0.954961834, 0.991260767, 6.988124875]},
      {"x" : "2014-07-30", "y" : [39.306138496, 52.00130636, 0.103709513, 1.101570706, 7.442802667]},
      {"x" : "2014-07-31", "y" : [33.401846334, 36.373117579, 0.090894286, 0.906238234, 7.03967423]}
    ]

    var day = 1
    var x = ['x']
    data.forEach(function (d) {
      x.push(day);
      day ++;
    })

    var ys = [['07/05'], ['07/10'], ['07/15'], ['07/20'], ['07/25'], ['avg']]
    var i  = 0
    while(i < y_lenght){
      data.forEach(function (d) {
        ys[i].push(d['y'][i])
      })
      i ++
    }

    data.forEach(function (d) {
      total = 0
      d['y'].forEach(function (d) {
        total += d
      })
      ys[y_lenght].push(total/y_lenght)
    })


    var chart = c3.generate({
      data: {
        xs: {
          '07/05' : 'x',
          '07/10' : 'x',
          '07/15' : 'x',
          '07/20' : 'x',
          '07/25' : 'x',
          'avg'   : 'x'
        },
        columns: [
          x,
          ys[0],
          ys[1],
          ys[2],
          ys[3],
          ys[4],
          ys[5]
        ]
      },
      axis : {
        x : {
          tick: {
            count: 31,
            format: function (x) { return '07/'+x}
          }
        },
        y : {
          max: 50,
          min: 0,
          type : 'timeseries',
          tick: {
            format: function (y) { return y+'s' },
          }
        }
      }
    });

  </script>
</html>
