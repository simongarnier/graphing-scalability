<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <title>Elasticsearch scalability test</title>
  </head>
  <style>

  </style>
  <body>
    <div id='chart'></div>
  </body>
  <link href='https://rawgit.com/masayuki0812/c3/master/c3.css' rel='stylesheet' type='text/css'>

  <script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.js' charset='utf-8'></script>
  <script src='https://rawgit.com/masayuki0812/c3/master/c3.js'></script>
  <script>
    //parsing the raw data
    var y_lenght = 5
    var data = [
                {"x" : "2014-07-01", "y" : [0.012060198, 0.015227367, 0.295363987, 0.014042457, 0.014299461]},
                {"x" : "2014-07-02", "y" : [0.009149383, 0.012077252, 0.013463938, 0.011440091, 0.167096108]},
                {"x" : "2014-07-03", "y" : [0.009150729, 0.008638114, 0.006077997, 0.124824093, 0.009866416]},
                {"x" : "2014-07-04", "y" : [0.136660897, 0.011197413, 0.01128791, 0.011358478, 0.008995137]},
                {"x" : "2014-07-05", "y" : [7.704576766, 0.009250737, 0.009124579, 0.010130524, 0.46924072]},
                {"x" : "2014-07-06", "y" : [5.4601758, 0.112834141, 0.006274178, 0.006246366, 0.024823842]},
                {"x" : "2014-07-07", "y" : [4.950410557, 0.027644188, 0.103395001, 0.004935636, 0.005046208]},
                {"x" : "2014-07-08", "y" : [5.690977595, 0.004616265, 0.004361279, 0.150290771, 0.005354609]},
                {"x" : "2014-07-09", "y" : [5.644572413, 0.005016701, 0.004944943, 0.004893864, 0.253256592]},
                {"x" : "2014-07-10", "y" : [7.444765333, 5.004381329, 0.491926474, 0.006481033, 0.00641876]},
                {"x" : "2014-07-11", "y" : [5.601790466, 5.147059495, 0.006341631, 0.006231538, 0.006229247]},
                {"x" : "2014-07-12", "y" : [4.846164645, 4.902710902, 0.00636246, 0.006719522, 0.006190841]},
                {"x" : "2014-07-13", "y" : [4.691660342, 4.891585733, 0.00557497, 0.006131204, 0.005623332]},
                {"x" : "2014-07-14", "y" : [4.441113454, 4.553073099, 0.005338117, 0.006325904, 0.005905126]},
                {"x" : "2014-07-15", "y" : [4.482129678, 4.527402726, 0.005448405, 0.00640189, 0.00576183]},
                {"x" : "2014-07-16", "y" : [4.233386061, 4.406159995, 0.005784255, 0.005610763, 0.019423627]},
                {"x" : "2014-07-17", "y" : [4.241426894, 4.361662458, 0.0185975, 0.005484826, 0.005485244]},
                {"x" : "2014-07-18", "y" : [4.257899497, 4.412354273, 0.017914377, 0.033425387, 0.005755053]},
                {"x" : "2014-07-19", "y" : [4.124745078, 4.329164301, 0.005167862, 0.013772299, 0.005284282]},
                {"x" : "2014-07-20", "y" : [3.370938595, 3.84756019, 0.004021208, 0.261614993, 0.144037473]},
                {"x" : "2014-07-21", "y" : [6.087586364, 4.655614973, 0.005926212, 0.370101709, 0.223919092]},
                {"x" : "2014-07-22", "y" : [4.512373699, 4.63626552, 0.042646931, 4.841107963, 0.663870922]},
                {"x" : "2014-07-23", "y" : [4.846125575, 4.36101793, 0.022384229, 1.835813008, 0.005191218]},
                {"x" : "2014-07-24", "y" : [4.407152271, 4.222437285, 0.023851148, 0.897479017, 0.131285225]},
                {"x" : "2014-07-25", "y" : [4.471880138, 6.947459018, 0.023325734, 0.50983474, 1.203642265]},
                {"x" : "2014-07-26", "y" : [4.352174274, 4.3928186, 0.025262601, 0.827850801, 1.075437981]},
                {"x" : "2014-07-27", "y" : [4.213291799, 4.402262777, 0.314417313, 0.556975041, 1.240717095]},
                {"x" : "2014-07-28", "y" : [4.648510723, 3.972991731, 0.055709315, 0.544423806, 1.241063165]},
                {"x" : "2014-07-29", "y" : [4.3416844, 4.416113695, 0.032298238, 0.496685387, 1.625036785]},
                {"x" : "2014-07-30", "y" : [4.506511757, 4.356285235, 0.078825436, 0.492961118, 1.745767674]},
                {"x" : "2014-07-31", "y" : [4.28108481, 4.506909162, 0.075858899, 3.269974532, 1.217344471]}
              ]

    var day = 1
    var x = ['x']
    data.forEach(function (d) {
      x.push(day);
      day ++;
    })

    var ys = [['07/05'], ['07/10'], ['07/15'], ['07/20'], ['07/25'], ['avg']]
    var i  = 0
    while(i < y_lenght){
      data.forEach(function (d) {
        ys[i].push(d['y'][i])
      })
      i ++
    }

    data.forEach(function (d) {
      total = 0
      d['y'].forEach(function (d) {
        total += d
      })
      ys[y_lenght].push(total/y_lenght)
    })


    var chart = c3.generate({
      data: {
        xs: {
          '07/05' : 'x',
          '07/10' : 'x',
          '07/15' : 'x',
          '07/20' : 'x',
          '07/25' : 'x',
          'avg'   : 'x'
        },
        columns: [
          x,
          ys[0],
          ys[1],
          ys[2],
          ys[3],
          ys[4],
          ys[5]
        ]
      },
      axis : {
        x : {
          tick: {
            count: 31,
            format: function (x) { return '07/'+x}
          }
        },
        y : {
          max: 50,
          min: 0,
          type : 'timeseries',
          tick: {
            format: function (y) { return y+'s' },
          }
        }
      }
    });

  </script>
</html>
